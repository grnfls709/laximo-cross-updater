# Инструкция по использованию скрипта для дополнения кросс-номеров

## Описание
Данный скрипт предназначен для автоматизации процесса дополнения кросс-номеров в Excel-файле номенклатуры с использованием API Laximo. Скрипт обрабатывает артикулы из Excel-файла, получает соответствующие кросс-номера через API Laximo и добавляет их в столбец "Текстовое описание".

## Требования
- Python 3.6 или выше
- Установленные библиотеки: `openpyxl`, `requests`
- Доступ к API Laximo (логин, пароль или API-ключ)

## Файлы в комплекте
1. `laximo_cross_updater.py` - основной скрипт для обработки Excel-файла
2. `mini_test_laximo.py` - тестовый скрипт для проверки работы API на минимальном наборе данных
3. `algorithm.md` - описание алгоритма работы скрипта
4. `mini_test_laximo_*.log` - лог тестового запуска

## Настройка перед использованием

### 1. Настройка доступа к API Laximo
В текущей версии скрипта используется базовый URL для API Laximo: `https://ws.laximo.net/ws/`. При тестировании были получены ошибки 404, что может указывать на:
- Необходимость авторизации для доступа к API
- Изменение URL конечной точки API
- Специфические требования к формату запросов

**Важно**: Перед использованием скрипта необходимо:
1. Уточнить актуальный URL API Laximo
2. Получить и настроить параметры авторизации (логин, пароль, API-ключ)
3. Обновить константу `LAXIMO_BASE_URL` в скрипте

### 2. Настройка путей к файлам
В скрипте необходимо указать корректные пути к файлам:
```python
EXCEL_FILE_PATH = "/путь/к/вашему/файлу.xlsx"  # Путь к исходному Excel-файлу
OUTPUT_FILE_PATH = "/путь/к/результату.xlsx"   # Путь для сохранения результата
```

### 3. Настройка параметров обработки
При необходимости можно изменить следующие параметры:
```python
SAVE_INTERVAL = 100  # Сохранять каждые N строк
REQUEST_DELAY = 0.5  # Задержка между запросами в секундах
```

## Использование

### Запуск основного скрипта
```bash
python3 laximo_cross_updater.py
```

Скрипт выполнит следующие действия:
1. Загрузит Excel-файл
2. Для каждой строки:
   - Получит артикул из 4-го столбца
   - Выполнит запрос к API Laximo для получения DetailId
   - Выполнит запрос к API Laximo для получения кросс-номеров
   - Добавит найденные кросс-номера в столбец "Текстовое описание" (6-й столбец)
3. Сохранит результат в указанный файл

### Запуск тестового скрипта
```bash
python3 mini_test_laximo.py
```

Тестовый скрипт проверит работу API на первых 3 артикулах из Excel-файла и выведет подробную информацию о результатах.

## Обработка ошибок и логирование

Скрипт ведет подробный лог своей работы, который сохраняется в файл с именем вида:
```
laximo_cross_update_YYYYMMDD_HHMMSS.log
```

В логе фиксируются:
- Успешно обработанные строки
- Строки с ошибками
- Причины ошибок
- Статистика обработки

## Известные проблемы и их решение

### Ошибка 404 при запросе к API
При тестировании все запросы к API Laximo возвращали ошибку 404 (Not Found). Возможные причины и решения:

1. **Неверный URL API**:
   - Уточните актуальный URL API Laximo у поставщика сервиса
   - Обновите константу `LAXIMO_BASE_URL` в скрипте

2. **Отсутствие авторизации**:
   - API Laximo может требовать авторизацию
   - Необходимо получить учетные данные и добавить их в запросы

3. **Неверный формат запроса**:
   - Проверьте актуальную документацию API
   - Возможно, требуется изменить формат параметров запроса

### Большой объем данных
Файл содержит около 10150 строк, что может привести к длительному времени обработки. Рекомендации:

1. Увеличьте интервал сохранения (`SAVE_INTERVAL`) для ускорения обработки
2. Разделите обработку на несколько частей, указав диапазоны строк
3. Запускайте скрипт в нерабочее время

## Дополнительные рекомендации

1. Перед обработкой всего файла рекомендуется сделать резервную копию
2. Для больших файлов рекомендуется сначала протестировать на небольшом наборе данных
3. При необходимости можно модифицировать скрипт для обработки только определенного диапазона строк

## Техническая поддержка

При возникновении проблем с использованием скрипта:
1. Проверьте лог-файл для выявления причин ошибок
2. Убедитесь, что все настройки (пути к файлам, URL API) указаны корректно
3. Проверьте доступность API Laximo и правильность учетных данных
